<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Screen | Earn Your Encore Karaoke</title>
  <style>
    body { margin:0; background:#0e0d2b; color:#fff; font-family:system-ui, sans-serif; }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 28px; }
    header { text-align:center; margin-bottom: 20px; }
    h1 { margin: 0 0 8px; color: #ffd24a; font-size: clamp(22px, 3.5vw, 40px); }
    p.sub { margin: 0; color: #c9fffa; font-size: clamp(14px, 2.2vw, 18px); opacity: 0.95; }
    .screen { display:grid; grid-template-columns: 320px 1fr; gap: 24px; align-items: center; }
    .panel { background: #1e1d3a; border-radius: 14px; padding: 16px; }
    .qr { display:flex; flex-direction:column; align-items:center; justify-content:center; gap:10px; }
    .qr img { width: 100%; max-width: 280px; height:auto; border-radius: 10px; background:#fff; padding:10px; }
    .link { font-size: 14px; word-break: break-all; color:#ddd; text-align:center; }
    .bar { background:#141335; border-radius:10px; padding:10px; margin:10px 0 16px; }
    .bar label { display:block; font-weight:600; margin-bottom:6px; }
    .track { width:100%; background:#0f0e2a; border-radius:8px; height:22px; overflow:hidden; }
    .fill { height:22px; width:0%; transition: width 400ms ease; }
    .fill.ok { background: #27ae60; }
    .fill.maybe { background: #f39c12; }
    .fill.no { background: #c0392b; }
    .pct { font-size:13px; opacity:0.9; margin-top:6px; }
    footer { margin-top: 10px; text-align:center; font-size:12px; color:#9ec8c8; opacity:0.9; }
    @media (max-width: 860px) { .screen { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Did this singer earn an Encore?</h1>
      <p class="sub">Scan the code to vote: üî• Encore ¬∑ ü§î One More Shot ¬∑ ‚ùå Maybe Next Time</p>
    </header>

    <div class="screen">
      <!-- QR -->
      <div class="panel qr">
        <img id="qr" alt="QR code to vote" />
        <div class="link" id="voteLink"></div>
      </div>

      <!-- Placeholder vote bars -->
      <div class="panel">
        <div class="bar">
          <label>üî• Encore</label>
          <div class="track"><div class="fill ok" id="barEncore"></div></div>
          <div class="pct" id="pctEncore">0 votes</div>
        </div>
        <div class="bar">
          <label>ü§î One More Shot</label>
          <div class="track"><div class="fill maybe" id="barOneMore"></div></div>
          <div class="pct" id="pctOneMore">0 votes</div>
        </div>
        <div class="bar">
          <label>‚ùå Maybe Next Time</label>
          <div class="track"><div class="fill no" id="barNextTime"></div></div>
          <div class="pct" id="pctNextTime">0 votes</div>
        </div>
      </div>
    </div>

    <footer>Earn Your Encore Karaoke ‚Äî An Interactive Upgrade for Karaoke Night!</footer>
  </div>

  <script>
    const BASE   = 'https://vote.earnyourencorekaraoke.com';
    const params = new URLSearchParams(location.search);

    // Grab sid + singer from the URL
    const sid    = params.get('sid')    || 'TEST';
    const singer = params.get('singer') || 'this singer';

    // Update header text with singer name
    const header = document.querySelector('h1');
    header.textContent = `Did ${singer} earn an Encore?`;

    // Build vote link
    const voteURL = `${BASE}/vote/?sid=${encodeURIComponent(sid)}&singer=${encodeURIComponent(singer)}`;

    // Generate QR code
    const qrImg = document.getElementById('qr');
    qrImg.src = `https://chart.googleapis.com/chart?cht=qr&chs=280x280&chl=${encodeURIComponent(voteURL)}`;

    // Show link under QR (backup if camera fails)
    document.getElementById('voteLink').textContent = voteURL;

    // --- Fake votes for demo (press 1,2,3 keys) ---
    let encore=0, one=0, nextt=0;
    function render() {
      const total = encore + one + nextt || 1;
      document.getElementById('barEncore').style.width = (encore/total*100)+'%';
      document.getElementById('barOneMore').style.width = (one/total*100)+'%';
      document.getElementById('barNextTime').style.width = (nextt/total*100)+'%';
      document.getElementById('pctEncore').textContent   = `${encore}
