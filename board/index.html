<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>EYEK • Board</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{--bg:#0a0e16;--text:#eaf2ff;--muted:#9db2d1;--green:#26e28b;--yellow:#ffd24d;--red:#ff5a6b;--border:#1c2b48}
  *{box-sizing:border-box;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial}
  body{margin:0;background:var(--bg);color:var(--text);padding:20px}
  h1{margin:0 0 10px 0}
  .muted{color:var(--muted)}
  table{width:100%;border-collapse:separate;border-spacing:0 8px}
  th,td{padding:12px 14px;text-align:left}
  tbody tr{background:#121826;border:1px solid var(--border)}
  .dot{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:8px}
  .green{background:var(--green)} .yellow{background:var(--yellow)} .red{background:var(--red)}
</style>
</head>
<body>
  <h1>Encore Board</h1>
  <div class="muted" id="line">—</div>
  <div style="height:10px"></div>
  <table>
    <thead>
      <tr><th>Singer</th><th>Last Song</th><th>Status</th></tr>
    </thead>
    <tbody id="rows"></tbody>
  </table>

<script>
const API='/assets/state.php'; let STATE=null, POLL;
function $(id){return document.getElementById(id)}
async function fetchState(){
  const r = await fetch(API+'?action=get',{cache:'no-store'});
  STATE = await r.json();
  render();
}
function render(){
  $('line').textContent = (STATE.venue||'') + (STATE.kj?(' • KJ '+STATE.kj):'');
  const body = $('rows'); body.innerHTML='';
  (STATE.singers||[]).forEach(s=>{
    const tr = document.createElement('tr');
    const status = s.status||'queued';
    const dot = status==='encore'?'green':(status==='another'?'yellow':(status==='nexttime'?'red':''));
    tr.innerHTML = `
      <td>${s.name}</td>
      <td class="muted">${s.lastSong||''}</td>
      <td>${dot?`<span class="dot ${dot}"></span>`:''}${status}</td>
    `;
    body.appendChild(tr);
  });
}
(async ()=>{ await fetchState(); POLL=setInterval(fetchState, 2000); })();
</script>
</body>
</html>
