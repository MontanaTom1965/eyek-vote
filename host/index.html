<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Host Dashboard | Earn Your Encore Karaoke</title>
  <style>
    body { margin:0; font-family:system-ui,sans-serif; background:#0e0d2b; color:#fff; }
    .wrap { max-width:920px; margin:0 auto; padding:28px; }
    h1 { color:#ffd24a; }
    .panel { background:#1e1d3a; border-radius:12px; padding:16px; margin:16px 0; }
    label { font-weight:600; margin:10px 0 4px; display:block; }
    input { width:100%; padding:10px; border:0; border-radius:6px; background:#141335; color:#fff; }
    button { margin-top:10px; padding:10px 16px; border:0; border-radius:6px; background:#2a2954; color:#fff; cursor:pointer; }
    .linkbox { display:grid; grid-template-columns:1fr auto; gap:8px; align-items:center; margin:8px 0; }
    .qr img { width:180px; height:180px; }
    .small { font-size:13px; color:#ccc; margin-top:8px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Host Dashboard</h1>
    <div class="panel">
      <label for="singer">Singer Name</label>
      <input id="singer" type="text" placeholder="e.g., Ashley">
      <label for="sid">Session Code</label>
      <input id="sid" type="text" placeholder="e.g., ABC123">
      <button id="genSid">Generate Code</button>
    </div>
    <div class="panel">
      <div class="linkbox">
        <input id="screenLink" type="text" readonly>
        <button data-copy="#screenLink">Copy</button>
      </div>
      <div class="linkbox">
        <input id="voteLink" type="text" readonly>
        <button data-copy="#voteLink">Copy</button>
      </div>
      <div class="qr">
        <img id="qr" alt="QR for vote link">
      </div>
      <div class="small">Open the <a id="openScreen" href="#" target="_blank">Screen link</a> on your TV.</div>
    </div>
  </div>

  <script>
    const BASE = 'https://vote.earnyourencorekaraoke.com';
    const singerEl = document.getElementById('singer');
    const sidEl = document.getElementById('sid');
    const screenEl = document.getElementById('screenLink');
    const voteEl = document.getElementById('voteLink');
    const qrImg = document.getElementById('qr');
    const openScreenA = document.getElementById('openScreen');

    // Generate a random session code
    function makeSid() { 
      return Math.random().toString(36).substring(2,8).toUpperCase(); 
    }

    // Update links + QR code
    function updateLinks() {
      const singer = encodeURIComponent(singerEl.value || 'this singer');
      const sid = encodeURIComponent(sidEl.value || 'TEST');
      const screenURL = `${BASE}/screen/?sid=${sid}&singer=${singer}`;
      const voteURL = `${BASE}/vote/?sid=${sid}&singer=${singer}`;
      screenEl.value = screenURL;
      voteEl.value = voteURL;
      openScreenA.href = screenURL;
      qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(voteURL)}`;
    }

    document.getElementById('genSid').addEventListener('click', ()=>{
      sidEl.value = makeSid();
      updateLinks();
    });
    singerEl.addEventListener('input', updateLinks);
    sidEl.addEventListener('input', updateLinks);

    // copy to clipboard
    document.addEventListener('click', e=>{
      if(e.target.dataset.copy){
        const sel = e.target.dataset.copy;
        const inp = document.querySelector(sel);
        navigator.clipboard.writeText(inp.value);
        e.target.textContent = "Copied!";
        setTimeout(()=>e.target.textContent="Copy",1000);
      }
    });

    // init with a random SID
    sidEl.value = makeSid();
    updateLinks();
  </script>
</body>
</html>
